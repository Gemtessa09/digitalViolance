<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>View Evidence - ReportSafe Admin</title>
    <link href="/css/style.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="/images/shield-icon.svg" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      .evidence-container {
        background: #1a1a1a;
        min-height: 500px;
        border-radius: 0.5rem;
        overflow: hidden;
      }

      .evidence-viewer {
        position: relative;
        width: 100%;
        height: 500px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .evidence-controls {
        position: absolute;
        bottom: 1rem;
        left: 0;
        right: 0;
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        z-index: 10;
      }

      .control-button {
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .control-button:hover {
        background: rgba(0, 0, 0, 0.9);
        transform: scale(1.1);
      }

      .evidence-nav {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 2rem;
        padding: 1rem;
        background: #2a2a2a;
      }

      .nav-button {
        background: #3a3a3a;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 0.25rem;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .nav-button:hover:not(:disabled) {
        background: #4a4a4a;
      }

      .nav-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .evidence-thumbnail {
        position: relative;
        border-radius: 0.25rem;
        overflow: hidden;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
      }

      .evidence-thumbnail.active {
        border-color: #3b82f6;
      }

      .evidence-thumbnail:hover {
        transform: scale(1.05);
      }

      .evidence-type-badge {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
      }

      .metadata-panel {
        background: white;
        border-radius: 0.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .metadata-item {
        display: flex;
        justify-content: space-between;
        padding: 0.75rem 0;
        border-bottom: 1px solid #e5e7eb;
      }

      .metadata-item:last-child {
        border-bottom: none;
      }

      .analysis-section {
        background: #f8fafc;
        border-radius: 0.5rem;
        border-left: 4px solid #3b82f6;
      }

      .tag {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.875rem;
        font-weight: 500;
      }

      .tag.harassment {
        background: #fee2e2;
        color: #991b1b;
      }
      .tag.threats {
        background: #fef3c7;
        color: #92400e;
      }
      .tag.image-abuse {
        background: #ede9fe;
        color: #5b21b6;
      }
      .tag.stalking {
        background: #dcfce7;
        color: #166534;
      }
      .tag.doxxing {
        background: #dbeafe;
        color: #1e40af;
      }
      .tag.deepfake {
        background: #fce7f3;
        color: #831843;
      }

      .verification-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.875rem;
        font-weight: 600;
      }

      .verified {
        background: #d1fae5;
        color: #065f46;
      }
      .unverified {
        background: #fef3c7;
        color: #92400e;
      }
      .tampered {
        background: #fee2e2;
        color: #991b1b;
      }

      .timeline {
        position: relative;
        padding-left: 2rem;
      }

      .timeline:before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 2px;
        background: #e5e7eb;
      }

      .timeline-item {
        position: relative;
        margin-bottom: 1.5rem;
        padding-left: 1.5rem;
      }

      .timeline-item:before {
        content: "";
        position: absolute;
        left: -7px;
        top: 0;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 3px solid white;
      }

      .timeline-item.evidence:before {
        background: #3b82f6;
        border-color: #3b82f6;
      }
      .timeline-item.review:before {
        background: #10b981;
        border-color: #10b981;
      }
      .timeline-item.action:before {
        background: #f59e0b;
        border-color: #f59e0b;
      }
      .timeline-item.escalated:before {
        background: #ef4444;
        border-color: #ef4444;
      }

      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.9);
        z-index: 1000;
      }

      .modal-overlay.show {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background: white;
        border-radius: 1rem;
        max-width: 800px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
      }

      .fullscreen-viewer {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: black;
        z-index: 2000;
        display: none;
      }

      .fullscreen-viewer.show {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .fullscreen-image {
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
      }

      .fullscreen-controls {
        position: absolute;
        top: 1rem;
        right: 1rem;
        display: flex;
        gap: 0.5rem;
        z-index: 2001;
      }

      .zoom-controls {
        position: absolute;
        bottom: 1rem;
        right: 1rem;
        display: flex;
        gap: 0.5rem;
        z-index: 2001;
      }

      .progress-bar {
        height: 4px;
        background: #e5e7eb;
        border-radius: 2px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: #3b82f6;
        width: 0%;
        transition: width 0.3s ease;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- Admin Layout -->
    <div class="flex h-screen">
      <!-- Sidebar (Same as dashboard) -->
      <aside class="sidebar bg-gray-900 text-white w-64 flex-shrink-0">
        <!-- Logo -->
        <div class="p-6 border-b border-gray-800">
          <div class="flex items-center space-x-3">
            <div class="bg-blue-600 p-2 rounded-lg">
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
                ></path>
              </svg>
            </div>
            <div>
              <h1 class="text-xl font-bold">ReportSafe</h1>
              <p class="text-xs text-gray-400">Evidence Viewer</p>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <nav class="p-4">
          <div class="space-y-1">
            <a
              href="dashboard.html"
              class="flex items-center space-x-3 px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition"
            >
              <i class="fas fa-tachometer-alt w-5 h-5"></i>
              <span>Dashboard</span>
            </a>

            <a
              href="reports.html"
              class="flex items-center space-x-3 px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition"
            >
              <i class="fas fa-file-alt w-5 h-5"></i>
              <span>All Reports</span>
            </a>

            <a
              href="view-report.html"
              class="flex items-center space-x-3 px-4 py-3 bg-blue-600/20 text-blue-300 rounded-lg"
            >
              <i class="fas fa-eye w-5 h-5"></i>
              <span>Evidence Viewer</span>
            </a>

            <a
              href="respond.html"
              class="flex items-center space-x-3 px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition"
            >
              <i class="fas fa-reply w-5 h-5"></i>
              <span>Response Center</span>
            </a>
          </div>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 overflow-auto">
        <!-- Top Bar -->
        <header class="bg-white shadow-sm border-b px-6 py-4">
          <div class="flex items-center justify-between">
            <div>
              <h1 class="text-2xl font-bold text-gray-900">Evidence Viewer</h1>
              <div class="flex items-center space-x-4 mt-1">
                <span class="font-mono font-bold text-blue-600"
                  >RS-2024-ABC123</span
                >
                <span class="text-sm text-gray-600"
                  >Harassment & Threats Case</span
                >
              </div>
            </div>

            <div class="flex items-center space-x-4">
              <a
                href="respond.html"
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition duration-200"
              >
                <i class="fas fa-reply mr-2"></i>
                Respond to Report
              </a>
              <a
                href="dashboard.html"
                class="text-gray-600 hover:text-gray-900"
              >
                <i class="fas fa-times text-xl"></i>
              </a>
            </div>
          </div>
        </header>

        <!-- Main Content -->
        <div class="p-6">
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column: Evidence Viewer -->
            <div class="lg:col-span-2 space-y-6">
              <!-- Evidence Viewer -->
              <div class="evidence-container">
                <div class="evidence-viewer" id="evidenceViewer">
                  <!-- Placeholder for evidence -->
                  <div class="text-center text-white p-8">
                    <i class="fas fa-image text-4xl mb-4 opacity-50"></i>
                    <h3 class="text-xl mb-2">Select evidence to view</h3>
                    <p class="text-gray-400">
                      Click on any evidence item from the list below
                    </p>
                  </div>
                </div>

                <div class="evidence-controls">
                  <button class="control-button" title="Zoom In">
                    <i class="fas fa-search-plus"></i>
                  </button>
                  <button class="control-button" title="Zoom Out">
                    <i class="fas fa-search-minus"></i>
                  </button>
                  <button class="control-button" title="Rotate">
                    <i class="fas fa-redo"></i>
                  </button>
                  <button class="control-button" title="Download">
                    <i class="fas fa-download"></i>
                  </button>
                  <button class="control-button" title="Fullscreen">
                    <i class="fas fa-expand"></i>
                  </button>
                </div>
              </div>

              <!-- Evidence Navigation -->
              <div class="evidence-nav">
                <button class="nav-button" id="prevEvidence" disabled>
                  <i class="fas fa-chevron-left mr-2"></i>
                  Previous
                </button>
                <span class="text-white font-medium">
                  Evidence <span id="currentIndex">0</span> of
                  <span id="totalEvidence">0</span>
                </span>
                <button class="nav-button" id="nextEvidence" disabled>
                  Next
                  <i class="fas fa-chevron-right ml-2"></i>
                </button>
              </div>

              <!-- Evidence Thumbnails -->
              <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4">
                  All Evidence Items
                </h2>

                <div
                  class="grid grid-cols-2 md:grid-cols-4 gap-4"
                  id="evidenceThumbnails"
                >
                  <!-- Thumbnails will be dynamically added here -->
                </div>

                <div class="mt-6">
                  <div class="flex justify-between items-center mb-2">
                    <span class="text-gray-700"
                      >Evidence Analysis Progress</span
                    >
                    <span id="analysisProgressText" class="font-bold">0%</span>
                  </div>
                  <div class="progress-bar">
                    <div id="analysisProgressFill" class="progress-fill"></div>
                  </div>
                </div>
              </div>

              <!-- Analysis Notes -->
              <div class="analysis-section p-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4">
                  Analysis Notes
                </h2>

                <div class="space-y-4">
                  <div>
                    <label class="block text-gray-700 mb-2 font-medium"
                      >Initial Assessment</label
                    >
                    <textarea
                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition min-h-[120px]"
                      placeholder="Enter your assessment of the evidence..."
                    >
Multiple clear threats identified in screenshots. Video evidence shows harassment pattern. Recommend escalation to legal team.</textarea
                    >
                  </div>

                  <div>
                    <label class="block text-gray-700 mb-2 font-medium"
                      >Tags</label
                    >
                    <div class="flex flex-wrap gap-2">
                      <span class="tag harassment">Harassment</span>
                      <span class="tag threats">Threats</span>
                      <span class="tag doxxing">Doxxing</span>
                      <span class="tag stalking">Cyberstalking</span>
                      <button
                        class="tag bg-gray-200 text-gray-700 hover:bg-gray-300"
                      >
                        <i class="fas fa-plus mr-1"></i>
                        Add Tag
                      </button>
                    </div>
                  </div>

                  <div class="flex justify-end space-x-4">
                    <button
                      class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-lg transition"
                    >
                      Save Notes
                    </button>
                    <button
                      class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition"
                    >
                      Mark as Reviewed
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right Column: Metadata & Timeline -->
            <div class="space-y-6">
              <!-- Report Metadata -->
              <div class="metadata-panel p-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4">
                  Report Metadata
                </h2>

                <div class="space-y-2">
                  <div class="metadata-item">
                    <span class="text-gray-600">Case ID</span>
                    <span class="font-mono font-bold">RS-2024-ABC123</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Report Type</span>
                    <span class="font-medium">Harassment & Threats</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Submitted</span>
                    <span>March 15, 2024 14:30</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Last Updated</span>
                    <span>March 18, 2024 09:15</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Status</span>
                    <span class="font-medium text-blue-600">Under Review</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Priority</span>
                    <span class="font-medium text-red-600">High</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Assigned To</span>
                    <span>Officer Jane Smith</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Report Method</span>
                    <span>Anonymous</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Platforms Involved</span>
                    <span>Instagram, WhatsApp</span>
                  </div>

                  <div class="metadata-item">
                    <span class="text-gray-600">Evidence Integrity</span>
                    <span class="verification-badge verified">
                      <i class="fas fa-shield-check mr-1"></i>
                      Verified
                    </span>
                  </div>
                </div>
              </div>

              <!-- Evidence Timeline -->
              <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4">
                  Evidence Timeline
                </h2>

                <div class="timeline">
                  <div class="timeline-item evidence">
                    <p class="font-medium text-gray-900">
                      Initial Evidence Submitted
                    </p>
                    <p class="text-sm text-gray-600">3 screenshots, 1 video</p>
                    <p class="text-xs text-gray-500">March 15, 14:30</p>
                  </div>

                  <div class="timeline-item review">
                    <p class="font-medium text-gray-900">
                      Evidence Analysis Started
                    </p>
                    <p class="text-sm text-gray-600">
                      Assigned to Officer Smith
                    </p>
                    <p class="text-xs text-gray-500">March 16, 09:15</p>
                  </div>

                  <div class="timeline-item action">
                    <p class="font-medium text-gray-900">
                      Additional Context Added
                    </p>
                    <p class="text-sm text-gray-600">
                      Victim provided timeline document
                    </p>
                    <p class="text-xs text-gray-500">March 17, 11:42</p>
                  </div>

                  <div class="timeline-item escalated">
                    <p class="font-medium text-gray-900">
                      Escalated for Legal Review
                    </p>
                    <p class="text-sm text-gray-600">
                      Clear threats identified
                    </p>
                    <p class="text-xs text-gray-500">Today, 10:30</p>
                  </div>
                </div>
              </div>

              <!-- Quick Actions -->
              <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4">
                  Quick Actions
                </h2>

                <div class="space-y-3">
                  <button
                    class="w-full bg-blue-50 hover:bg-blue-100 text-blue-700 font-medium py-3 px-4 rounded-lg transition flex items-center justify-center"
                  >
                    <i class="fas fa-download mr-2"></i>
                    Download All Evidence
                  </button>

                  <button
                    class="w-full bg-green-50 hover:bg-green-100 text-green-700 font-medium py-3 px-4 rounded-lg transition flex items-center justify-center"
                  >
                    <i class="fas fa-check-circle mr-2"></i>
                    Mark as Complete
                  </button>

                  <button
                    class="w-full bg-red-50 hover:bg-red-100 text-red-700 font-medium py-3 px-4 rounded-lg transition flex items-center justify-center"
                  >
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    Escalate to Legal
                  </button>

                  <button
                    class="w-full bg-yellow-50 hover:bg-yellow-100 text-yellow-700 font-medium py-3 px-4 rounded-lg transition flex items-center justify-center"
                  >
                    <i class="fas fa-question-circle mr-2"></i>
                    Request More Info
                  </button>
                </div>
              </div>

              <!-- Related Cases -->
              <div class="bg-white rounded-xl shadow-sm p-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4">
                  Related Cases
                </h2>

                <div class="space-y-3">
                  <a
                    href="#"
                    class="block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition"
                  >
                    <div class="font-mono font-bold text-sm">
                      RS-2024-DEF456
                    </div>
                    <div class="text-sm text-gray-600">
                      Similar perpetrator pattern
                    </div>
                    <div
                      class="flex justify-between text-xs text-gray-500 mt-1"
                    >
                      <span>Threats</span>
                      <span>Resolved</span>
                    </div>
                  </a>

                  <a
                    href="#"
                    class="block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition"
                  >
                    <div class="font-mono font-bold text-sm">
                      RS-2024-XYZ789
                    </div>
                    <div class="text-sm text-gray-600">
                      Same platform (Instagram)
                    </div>
                    <div
                      class="flex justify-between text-xs text-gray-500 mt-1"
                    >
                      <span>Harassment</span>
                      <span>Under Review</span>
                    </div>
                  </a>

                  <a
                    href="#"
                    class="block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition"
                  >
                    <div class="font-mono font-bold text-sm">
                      RS-2024-JKL012
                    </div>
                    <div class="text-sm text-gray-600">Linked phone number</div>
                    <div
                      class="flex justify-between text-xs text-gray-500 mt-1"
                    >
                      <span>Doxxing</span>
                      <span>Action Required</span>
                    </div>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Fullscreen Viewer -->
    <div class="fullscreen-viewer" id="fullscreenViewer">
      <div class="fullscreen-controls">
        <button class="control-button" onclick="zoomIn()">
          <i class="fas fa-search-plus"></i>
        </button>
        <button class="control-button" onclick="zoomOut()">
          <i class="fas fa-search-minus"></i>
        </button>
        <button class="control-button" onclick="rotateImage()">
          <i class="fas fa-redo"></i>
        </button>
        <button class="control-button" onclick="closeFullscreen()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <img id="fullscreenImage" class="fullscreen-image" src="" alt="" />

      <div class="zoom-controls">
        <span
          id="zoomLevel"
          class="text-white bg-black/50 px-2 py-1 rounded text-sm"
          >100%</span
        >
      </div>
    </div>

    <!-- JavaScript -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Evidence Data
        const evidenceItems = [
          {
            id: 1,
            type: "image",
            title: "Screenshot 1 - Threatening Messages",
            description: "Instagram direct messages showing explicit threats",
            url: "/uploads/images/screenshot1.jpg",
            thumbnail: "/uploads/images/thumb1.jpg",
            verified: true,
            timestamp: "March 12, 2024 21:15",
            tags: ["threats", "harassment"],
          },
          {
            id: 2,
            type: "image",
            title: "Screenshot 2 - Continued Harassment",
            description: "Follow-up messages after initial report",
            url: "/uploads/images/screenshot2.jpg",
            thumbnail: "/uploads/images/thumb2.jpg",
            verified: true,
            timestamp: "March 13, 2024 09:42",
            tags: ["harassment"],
          },
          {
            id: 3,
            type: "video",
            title: "Video Evidence - Screen Recording",
            description: "Screen recording of ongoing harassment",
            url: "/uploads/videos/recording.mp4",
            thumbnail: "/uploads/images/video-thumb.jpg",
            verified: true,
            duration: "2:45",
            timestamp: "March 14, 2024 14:20",
            tags: ["harassment", "stalking"],
          },
          {
            id: 4,
            type: "document",
            title: "Timeline Document",
            description: "Victim-provided timeline of incidents",
            url: "/uploads/documents/timeline.pdf",
            thumbnail: "/uploads/images/doc-thumb.jpg",
            verified: false,
            timestamp: "March 17, 2024 11:42",
            tags: ["context"],
          },
        ];

        // DOM Elements
        const evidenceViewer = document.getElementById("evidenceViewer");
        const evidenceThumbnails =
          document.getElementById("evidenceThumbnails");
        const currentIndex = document.getElementById("currentIndex");
        const totalEvidence = document.getElementById("totalEvidence");
        const prevButton = document.getElementById("prevEvidence");
        const nextButton = document.getElementById("nextEvidence");
        const analysisProgressFill = document.getElementById(
          "analysisProgressFill"
        );
        const analysisProgressText = document.getElementById(
          "analysisProgressText"
        );
        const fullscreenViewer = document.getElementById("fullscreenViewer");
        const fullscreenImage = document.getElementById("fullscreenImage");
        const zoomLevel = document.getElementById("zoomLevel");

        // State
        let currentEvidenceIndex = 0;
        let zoom = 1;
        let rotation = 0;

        // Initialize
        totalEvidence.textContent = evidenceItems.length;
        updateAnalysisProgress();
        renderThumbnails();
        showEvidence(0);

        // Render thumbnails
        function renderThumbnails() {
          evidenceThumbnails.innerHTML = "";

          evidenceItems.forEach((item, index) => {
            const thumbnail = document.createElement("div");
            thumbnail.className = `evidence-thumbnail ${
              index === currentEvidenceIndex ? "active" : ""
            }`;
            thumbnail.dataset.index = index;

            thumbnail.innerHTML = `
                        <img src="${item.thumbnail}" alt="${
              item.title
            }" class="w-full h-32 object-cover">
                        <div class="evidence-type-badge">
                            ${getTypeIcon(item.type)}
                        </div>
                        <div class="p-2 bg-black/70 text-white text-xs">
                            <div class="font-medium truncate">${
                              item.title
                            }</div>
                        </div>
                    `;

            thumbnail.addEventListener("click", () => showEvidence(index));
            evidenceThumbnails.appendChild(thumbnail);
          });
        }

        // Get type icon
        function getTypeIcon(type) {
          const icons = {
            image: "ðŸ“·",
            video: "ðŸŽ¥",
            document: "ðŸ“„",
            audio: "ðŸŽµ",
          };
          return icons[type] || "ðŸ“Ž";
        }

        // Show evidence
        function showEvidence(index) {
          if (index < 0 || index >= evidenceItems.length) return;

          currentEvidenceIndex = index;
          const item = evidenceItems[index];

          // Update navigation
          currentIndex.textContent = index + 1;
          prevButton.disabled = index === 0;
          nextButton.disabled = index === evidenceItems.length - 1;

          // Update active thumbnail
          document
            .querySelectorAll(".evidence-thumbnail")
            .forEach((thumb, i) => {
              thumb.classList.toggle("active", i === index);
            });

          // Update viewer
          evidenceViewer.innerHTML = "";

          if (item.type === "image") {
            const img = document.createElement("img");
            img.src = item.url;
            img.alt = item.title;
            img.className = "max-w-full max-h-full object-contain";
            img.onclick = () => openFullscreen(item.url);
            evidenceViewer.appendChild(img);
          } else if (item.type === "video") {
            const video = document.createElement("video");
            video.src = item.url;
            video.controls = true;
            video.className = "max-w-full max-h-full";
            evidenceViewer.appendChild(video);
          } else if (item.type === "document") {
            evidenceViewer.innerHTML = `
                        <div class="text-center p-8">
                            <i class="fas fa-file-pdf text-6xl text-red-500 mb-4"></i>
                            <h3 class="text-xl font-bold text-white mb-2">${item.title}</h3>
                            <p class="text-gray-300 mb-4">${item.description}</p>
                            <a href="${item.url}" target="_blank" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-6 rounded-lg transition inline-flex items-center">
                                <i class="fas fa-external-link-alt mr-2"></i>
                                Open Document
                            </a>
                        </div>
                    `;
          }

          // Update analysis progress
          updateAnalysisProgress();
        }

        // Update analysis progress
        function updateAnalysisProgress() {
          const reviewedItems = evidenceItems.filter(
            (item) => item.verified
          ).length;
          const progress = (reviewedItems / evidenceItems.length) * 100;

          analysisProgressFill.style.width = `${progress}%`;
          analysisProgressText.textContent = `${Math.round(progress)}%`;
        }

        // Navigation
        prevButton.addEventListener("click", () => {
          if (currentEvidenceIndex > 0) {
            showEvidence(currentEvidenceIndex - 1);
          }
        });

        nextButton.addEventListener("click", () => {
          if (currentEvidenceIndex < evidenceItems.length - 1) {
            showEvidence(currentEvidenceIndex + 1);
          }
        });

        // Fullscreen viewer
        function openFullscreen(imageUrl) {
          fullscreenImage.src = imageUrl;
          fullscreenViewer.classList.add("show");
          zoom = 1;
          rotation = 0;
          updateFullscreenTransform();
        }

        function closeFullscreen() {
          fullscreenViewer.classList.remove("show");
        }

        function zoomIn() {
          zoom = Math.min(zoom + 0.25, 3);
          updateFullscreenTransform();
        }

        function zoomOut() {
          zoom = Math.max(zoom - 0.25, 0.5);
          updateFullscreenTransform();
        }

        function rotateImage() {
          rotation = (rotation + 90) % 360;
          updateFullscreenTransform();
        }

        function updateFullscreenTransform() {
          fullscreenImage.style.transform = `scale(${zoom}) rotate(${rotation}deg)`;
          zoomLevel.textContent = `${Math.round(zoom * 100)}%`;
        }

        // Keyboard shortcuts
        document.addEventListener("keydown", (e) => {
          if (fullscreenViewer.classList.contains("show")) {
            switch (e.key) {
              case "Escape":
                closeFullscreen();
                break;
              case "+":
              case "=":
                zoomIn();
                break;
              case "-":
                zoomOut();
                break;
              case "r":
              case "R":
                rotateImage();
                break;
            }
          } else {
            switch (e.key) {
              case "ArrowLeft":
                if (currentEvidenceIndex > 0) {
                  showEvidence(currentEvidenceIndex - 1);
                }
                break;
              case "ArrowRight":
                if (currentEvidenceIndex < evidenceItems.length - 1) {
                  showEvidence(currentEvidenceIndex + 1);
                }
                break;
            }
          }
        });

        // Close fullscreen when clicking outside image
        fullscreenViewer.addEventListener("click", (e) => {
          if (e.target === fullscreenViewer) {
            closeFullscreen();
          }
        });

        // Mark evidence as verified
        window.markAsVerified = function (evidenceId) {
          const item = evidenceItems.find((item) => item.id === evidenceId);
          if (item) {
            item.verified = !item.verified;
            updateAnalysisProgress();

            // Update thumbnail
            const thumb = document.querySelector(
              `[data-index="${evidenceId - 1}"]`
            );
            if (thumb) {
              const badge = thumb.querySelector(".evidence-type-badge");
              badge.innerHTML = item.verified
                ? "âœ… Verified"
                : getTypeIcon(item.type);
            }
          }
        };

        // Download evidence
        window.downloadEvidence = function (evidenceId) {
          const item = evidenceItems.find((item) => item.id === evidenceId);
          if (item) {
            alert(`Downloading: ${item.title}`);
            // In real app, this would trigger file download
          }
        };
      });
    </script>
  </body>
</html>
